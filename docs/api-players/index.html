<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://jandie1505.github.io/PlayerLevels/api-players/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Players - PlayerLevels</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Players";
        var mkdocs_page_input_path = "api-players.md";
        var mkdocs_page_url = "/PlayerLevels/api-players/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> PlayerLevels
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Setup</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Plugin usage</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../leveling/">Leveling</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rewards/">Rewards</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../commands/">Commands</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../api-getting-started/">Getting started</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Players</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#getting-a-player">Getting a player</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#modifying-player-data">Modifying player data</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#level-and-xp">Level and XP</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#received-reward-entries">Received reward entries</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#processing-a-player">Processing a player</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cache-database-and-synchronization">Cache, database and synchronization</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#deleting-a-player">Deleting a player</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../api-rewards/">Rewards</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="../javadoc/index.html">JavaDoc</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Integrations</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../integrations-placeholderapi/">PlaceholderAPI</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../integrations-cloudnet/">CloudNet</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">PlayerLevels</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API</li>
      <li class="breadcrumb-item active">Players</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-players">API: Players</h1>
<h3 id="getting-a-player">Getting a player</h3>
<p>In PlayerLevels, players are represented by a Leveler.<br />
You can obtain a Leveler by using the LevelingManager.</p>
<pre class="codehilite"><code class="language-java">Player player;
LevelingManager levelManager = api.getLevelManager();

// Get a cached Leveler
Leveler cachedLeveler = levelManager.getLeveler(player.getUniqueId());

// If the leveler is not loaded, you can load it from the database.
// Normally, the Leveler of all online players is loaded.
// Since loadLeveler loads data from a database asynchronously, it returns a CompletableFuture of an Leveler.
CompletableFuture&lt;Leveler&gt; future = levelManager.loadLeveler(player.getUniqueId());

future.thenAccept(leveler -&gt; {
    // Do stuff

    // If you need to use the Bukkit API, you need to go back into the main thread
    new BukkitRunnable() {
        @Override
        public void run() {
            // Do Bukkit API stuff
        }
    }.runTask(plugin);
});
</code></pre>

<h3 id="modifying-player-data">Modifying player data</h3>
<h4 id="level-and-xp">Level and XP</h4>
<p>The Leveler contains the LevelerData, which stores the players leveling information.</p>
<p>You can use this data to modify the player's level and xp:</p>
<pre class="codehilite"><code class="language-java">// Get the leveler's data
LevelerData data = leveler.getData();

// Get/Set Level
int level = data.level();
data.level(10);

// Get/Set XP
double xp = data.xp();
data.xp(10);
</code></pre>

<h4 id="received-reward-entries">Received reward entries</h4>
<p>The LevelerData also stores which rewards the player has already received.<br />
You can modify this information:</p>
<pre class="codehilite"><code class="language-java">// Get the leveler's data
LevelerData data = leveler.getData();

// Get all received reward entries
Map&lt;String, ReceivedReward&gt; receivedRewards = data.getReceivedRewards();

// Get one received reward entry
ReceivedReward reward = data.getReceivedReward(&quot;my_reward&quot;);

// Set the the reward blocked (the player will not receive the reward when it's blocked)
boolean blocked = reward.blocked();
reward.blocked(true);

// Set the level where the player has received the reward.
// The plugin uses this information to check if the player has already received the reward.
int receivedLevel = reward.level();
reward.level(10);

// Reset the reward entry to the default reward entry.
// A default reward entry will remove it from the database on the next sync.
reward.reset();

// Deleting an entry
data.removeReceivedReward(&quot;my_reward&quot;);
</code></pre>

<h4 id="processing-a-player">Processing a player</h4>
<p>When PlayerLevels processes a player, this means that it checks if the player has enough xp to level up,
checks if any reward can be applied to the player, updates the cached name and cleans up unused received reward entries when enabled.</p>
<p>Normally, players are automatically processed in a specific interval.</p>
<p>If you have changed the level or xp of a player, you should process the player manually, because if you don't,
the player could see incorrect values for the next few minutes.</p>
<pre class="codehilite"><code class="language-java">Leveler leveler;
leveler.processAsynchronously();
</code></pre>

<h4 id="cache-database-and-synchronization">Cache, database and synchronization</h4>
<p>The plugin stores the player data in a MariaDB database.<br />
Since it would be very resource-heavy for the database when every command will send a request to it,
PlayerLevels caches the data of all online players.</p>
<p>To keep the data in the database up-to-date, PlayerLevels synchronizes the data every few minutes.<br />
When the player leaves, the data is also pushed to the database (and the player is removed from the cache).</p>
<p>You can also sync the data with the database manually:</p>
<pre class="codehilite"><code class="language-java">Leveler leveler;
leveler.syncAsynchronously();
</code></pre>

<p>This will return a result, which allows you to see if the sync was successful.</p>
<p>Please note that the database always has priority.
If there have been changes both in the database and locally, the data from the database is always adopted.
If this happened, you will see it in the returned result.</p>
<h3 id="deleting-a-player">Deleting a player</h3>
<p>If you want to, you can also delete a player completely from the database and cache:</p>
<pre class="codehilite"><code class="language-java">UUID playerId;
LevelingManager levelingManager;
levelingManager.erasePlayerAsynchronously(playerId);
</code></pre>

<p>It is recommended that the player is offline when you delete them,
because if not, the plugin would just create a new Leveler instance.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../api-getting-started/" class="btn btn-neutral float-left" title="Getting started"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../api-rewards/" class="btn btn-neutral float-right" title="Rewards">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../api-getting-started/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../api-rewards/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
